

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5. Systèmes dynamiques : utilisation de SciPy &mdash; Python scientifique - ENS Paris</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2013.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="top" title="Python scientifique - ENS Paris" href="index.html" />
    <link rel="next" title="6. Et pour aller plus loin" href="aller_plus_loin.html" />
    <link rel="prev" title="4. Équations aux dérivées partielles : utilisation de NumPy" href="edp_chaleur.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="aller_plus_loin.html" title="6. Et pour aller plus loin"
             accesskey="N">suivant</a></li>
        <li class="right" >
          <a href="edp_chaleur.html" title="4. Équations aux dérivées partielles : utilisation de NumPy"
             accesskey="P">précédent</a> |</li>
        <li><a href="index.html">Python scientifique - ENS Paris</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="systemes-dynamiques-utilisation-de-scipy">
<h1>5. Systèmes dynamiques : utilisation de SciPy<a class="headerlink" href="#systemes-dynamiques-utilisation-de-scipy" title="Lien permanent vers ce titre">¶</a></h1>
<div class="topic">
<p class="topic-title first">Contenu du chapitre</p>
<ul class="simple">
<li>Présentation du module SciPy</li>
<li>Réalisation de traitements de données avancés avec SciPy</li>
<li>Génération de figures avancées avec Matplotlib</li>
<li>Ecrire la documentation d&#8217;une fonction</li>
</ul>
</div>
<p>Dans les modules scientifiques de Python, il existe une collection
impressionnante de fonctions réalisant des opérations diverses sur les
tableaux numériques de NumPy. Il faut surtout les utiliser, plutôt que de
réinventer la roue en recodant (probablement moins bien) une
fonctionnalité qui existe déjà par ailleurs !</p>
<p>Dans <strong>NumPy</strong>, on a déjà vu qu&#8217;il existe beaucoup d&#8217;opérations
permettant par exemple de</p>
<blockquote>
<div><ul class="simple">
<li>générer des tableaux particuliers : <tt class="docutils literal"><span class="pre">np.arange</span></tt>, <tt class="docutils literal"><span class="pre">np.ones</span></tt>,
<tt class="docutils literal"><span class="pre">np.linspace</span></tt>, ...</li>
<li>faire des opérations à partir des valeurs du tableau : <tt class="docutils literal"><span class="pre">np.sum</span></tt>,
<tt class="docutils literal"><span class="pre">np.sin</span></tt>, <tt class="docutils literal"><span class="pre">np.histogram</span></tt>, etc.</li>
<li>exprimer des conditions (booléennes) sur les éléments d&#8217;un tableau ou
extraire des parties d&#8217;un tableau :
<tt class="docutils literal"><span class="pre">np.logical_not</span></tt>,  <tt class="docutils literal"><span class="pre">np.in1d</span></tt></li>
<li>changer l&#8217;agencement des valeurs d&#8217;un tableau, sa forme, ou encore
créer un nouveau tableau à partir de plusieurs autres :
<tt class="docutils literal"><span class="pre">np.reshape</span></tt>, <tt class="docutils literal"><span class="pre">np.concatenate</span></tt>.</li>
<li>etc. ...</li>
</ul>
</div></blockquote>
<p>Le module <strong>SciPy</strong> est la <strong>boîte à outils</strong> numérique pour les tableaux
NumPy. On trouve dans <strong>SciPy</strong> les opérations de manipulation /
traitement de données numériques classiques, mais spécifiques à un type
d&#8217;application (algébre linéaire, statistiques, etc.). Ce sont donc des
fonctions plus &#8220;haut niveau&#8221; que celles de NumPy.</p>
<p>SciPy est un module stable, bien testé et relativement bien documenté.</p>
<p><a class="reference external" href="http://docs.scipy.org/doc/">http://docs.scipy.org/doc/</a>
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/">http://docs.scipy.org/doc/scipy/reference/</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span>
<div class="newline"></div></pre></div>
</div>
<p>Le module SciPy réalise les différentes opérations sur des tableaux
numériques (<tt class="docutils literal"><span class="pre">ndarray</span></tt>) de <tt class="docutils literal"><span class="pre">numpy</span></tt>. On peut donc directement utiliser
ces tableaux comme arguments pour les différentes fonctions</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span>
<div class="newline"></div><span class="go">array([[1, 2],</span>
<div class="newline"></div><span class="go">    [2, 4]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<div class="newline"></div><span class="go">0.0</span>
<div class="newline"></div></pre></div>
</div>
<p>Pour montrer l&#8217;utilisation de SciPy, nous allons nous intéresser à
l&#8217;intégration d&#8217;équations différentielles, en considérant des systèmes
dynamiques à base de pendules mécaniques.</p>
<div class="section" id="pendule-simple">
<h2>5.1. Pendule simple<a class="headerlink" href="#pendule-simple" title="Lien permanent vers ce titre">¶</a></h2>
<a class="reference internal image-reference" href="_images/pendulum.png"><img alt="_images/pendulum.png" class="align-center" src="_images/pendulum.png" style="width: 250.0px; height: 370.5px;" /></a>
<p>En écrivant la relation fondamentale de la dynamique (conservation de la
quantité de mouvement), on obtient l&#8217;équation du pendule simple donnée par</p>
<div class="math">
<p><img src="_images/math/c24308e0cf4cfbde7ba51595fb918a99aca1dae2.png" alt="\ddot{\theta} + \omega^2 \sin\theta = 0"/></p>
</div><p>où <img class="math" src="_images/math/52e8ed7a3ba22130ad3984eb2cd413406475a689.png" alt="\theta" style="vertical-align: 0px"/> est l&#8217;angle du pendule par rapport à la verticale, et
on note avec un point la dérivée temporelle.</p>
<p>Pour les petites oscillations on peut faire l&#8217;approximation
<img class="math" src="_images/math/6514e2ea9419f41ec217149ceac594aff087022e.png" alt="\sin\theta\simeq\theta" style="vertical-align: -1px"/>. Quand l&#8217;approximation n&#8217;est pas valide il
faut intégrer numériquement cette équation différentielle pour obtenir
l&#8217;évolution de la position et de la vitesse angulaire du pendule, au
cours du temps.</p>
<p>Il nous faut donc disposer d&#8217;un intégrateur d&#8217;équations différentielles,
que l&#8217;on peut s&#8217;attendre à trouver dans SciPy. Mais quelle est la
fonction correspondante ? Tentons une recherche Google &#8220;scipy integrate
differential equation&#8221;, ou la consultation du sommaire de l&#8217;aide
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/index.html">http://docs.scipy.org/doc/scipy/reference/index.html</a>. Il existe un
sous-module <tt class="docutils literal"><span class="pre">integrate</span></tt>, qui contient lui-même une fonction
<tt class="docutils literal"><span class="pre">odeint</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<div class="newline"></div></pre></div>
</div>
<p>Regarder la doc de la fonction
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint">http://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint</a>
et l&#8217;exemple
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/tutorial/integrate.html#ordinary-differential-equations-odeint">http://docs.scipy.org/doc/scipy/reference/tutorial/integrate.html#ordinary-differential-equations-odeint</a></p>
<p>Pour commencer, il faut mettre l&#8217;équation différentielle du 2nd ordre
sous la forme d&#8217;un système d&#8217;équations du premier ordre</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">simple_pendulum</span><span class="p">(</span><span class="n">theta_thetadot</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<div class="newline"></div>    <span class="n">theta</span><span class="p">,</span> <span class="n">theta_dot</span> <span class="o">=</span> <span class="n">theta_thetadot</span>
<div class="newline"></div>    <span class="k">return</span> <span class="p">[</span><span class="n">theta_dot</span><span class="p">,</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
<div class="newline"></div></pre></div>
</div>
<p>correspondant à</p>
<div class="math">
<p><img src="_images/math/ce1d4be375090c6e9ee8175e31d4e8aa4bb9cba9.png" alt="\frac{\mathrm{d}\theta}{\mathrm{d}t} = \dot{\theta}

\frac{\mathrm{d}\dot{\theta}}{\mathrm{d}t} = -\sin\theta"/></p>
</div><p>Nous pouvons maintenant intégrer une trajectoire à partir d&#8217;une condition
initiale</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">simple_pendulum</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Attention</p>
<p class="last">Comme la fonction <tt class="docutils literal"><span class="pre">odeint</span></tt>, il existe un grand nombre de fonctions
permettant de réaliser des opérations haut niveau de calcul
scientifique.</p>
</div>
<p>Nous pouvons par exemple vérifier la conservation de l&#8217;énergie mécanique
au cours du temps</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span><span class="p">,</span> <span class="n">theta_dot</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">T</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">E_kin</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">theta_dot</span> <span class="o">**</span> <span class="mi">2</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">E_pot</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="c"># z</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">E_mech</span> <span class="o">=</span> <span class="n">E_kin</span> <span class="o">+</span> <span class="n">E_pot</span>
<div class="newline"></div></pre></div>
</div>
<div class="figure">
<a class="reference external image-reference" href="auto_examples/plot_simple_pendulum.html"><img alt="_images/plot_simple_pendulum_1.png" src="_images/plot_simple_pendulum_1.png" style="width: 640.0px; height: 480.0px;" /></a>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">E_kin</span><span class="p">,</span> <span class="s">&#39;o-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">u&#39;$E_\mathrm{kin}$&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">E_pot</span><span class="p">,</span> <span class="s">&#39;o-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">u&#39;$E_\mathrm{pot}$&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">E_mech</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">u&#39;$E_\mathrm{mech}$&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<div class="newline"></div></pre></div>
</div>
<p>Pour générer la figure ci-dessus, on a utilisé un certain nombre de
commandes du module <tt class="docutils literal"><span class="pre">matplotlib</span></tt>.</p>
<p>[<a class="reference internal" href="auto_examples/plot_simple_pendulum.html#example-plot-simple-pendulum-py"><em>Python source code</em></a>]</p>
<p>Pour construire les différents éléments de la figure (courbe, labels,
légende, etc.), il existe des fonctions dédiées de matplotlib qu&#8217;on peut
&#8220;découvrir&#8221; grâce à la documentation de matplotlib
<a class="reference external" href="http://matplotlib.org/">http://matplotlib.org/</a>. En particulier, la gallerie d&#8217;exemples
<a class="reference external" href="http://matplotlib.org/gallery.html">http://matplotlib.org/gallery.html</a> est très utile pour voir comment
générer différents types de figures.</p>
<div class="topic">
<p class="topic-title first">Exercice</p>
<p>Ecrire un script python pour construire le diagramme des phases du
pendule simple, représenté ci-dessous. Pour celà, il faut</p>
<blockquote>
<div><ul class="simple">
<li>intégrer l&#8217;équation différentielle pour différentes conditions
initiales entre 0 et <img class="math" src="_images/math/f2ca003a7da0de4994b4733e203b74ff52d42553.png" alt="\pi" style="vertical-align: 0px"/>.</li>
<li>représenter <img class="math" src="_images/math/b968505d78f325a99a639297b7a081e041f4b007.png" alt="\dot{\theta}" style="vertical-align: 0px"/> en fonction de <img class="math" src="_images/math/52e8ed7a3ba22130ad3984eb2cd413406475a689.png" alt="\theta" style="vertical-align: 0px"/>
pour les différentes solutions.</li>
</ul>
</div></blockquote>
<div class="figure">
<a class="reference external image-reference" href="auto_examples/plot_phase_diagram.html"><img alt="_images/plot_phase_diagram_1.png" src="_images/plot_phase_diagram_1.png" style="width: 480.0px; height: 480.0px;" /></a>
</div>
<p>[<a class="reference internal" href="auto_examples/plot_phase_diagram.html#example-plot-phase-diagram-py"><em>Solution de l&#8217;exercice</em></a>]</p>
</div>
</div>
<div class="section" id="pendule-force">
<h2>5.2. Pendule forcé<a class="headerlink" href="#pendule-force" title="Lien permanent vers ce titre">¶</a></h2>
<p>On peut rajouter un degré de liberté au système dynamique du pendule en
imposant un forçage dépendant du temps, par exemple périodique en temps.
Nous allons également considérer un amortissement du pendule dû au
frottement de l&#8217;air. On considère alors l&#8217;équation suivante pour le
pendule forcé</p>
<div class="math">
<p><img src="_images/math/3e1c898e07d4e328739fa049f9412b999ee608fc.png" alt="\ddot{\theta} + q \dot{\theta} + \omega^2 \sin\theta = A \sin
\omega_D t"/></p>
</div><p>Comme auparavant, on normalise le temps en fixant <img class="math" src="_images/math/31d3b9cbf0763001f4f5fc668df31fcec69556e1.png" alt="\omega = 1" style="vertical-align: -1px"/>. Il
reste alors trois paramètres sur lesquels on peut jouer : A, q et
<img class="math" src="_images/math/fbc7f74c3555a1a46bc204385e4c57b29094375b.png" alt="\omega_D" style="vertical-align: -4px"/>. On définit donc une nouvelle fonction définissant le
système dynamique du premier ordre</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">forced_pendulum_equations</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>
<div class="newline"></div>    <span class="n">theta</span><span class="p">,</span> <span class="n">theta_dot</span> <span class="o">=</span> <span class="n">y</span>
<div class="newline"></div>    <span class="k">return</span> <span class="p">[</span><span class="n">theta_dot</span><span class="p">,</span> <span class="n">acc</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> \
<div class="newline"></div>                    <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">-</span> <span class="n">q</span> <span class="o">*</span> <span class="n">theta_dot</span><span class="p">]</span>
<div class="newline"></div></pre></div>
</div>
<p>Par commodité, on va également définir une fonction permettant d&#8217;intégrer
une trajectoire à partir d&#8217;une condition initiale, sur un certain
intervalle de temps:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">forced_pendulum</span><span class="p">(</span><span class="n">t_end</span><span class="p">,</span> <span class="n">t_space</span><span class="p">,</span> <span class="n">theta_init</span><span class="p">,</span> <span class="n">theta_dot_init</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<div class="newline"></div>                            <span class="n">acc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<div class="newline"></div>    <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">t_space</span><span class="p">)</span>
<div class="newline"></div>    <span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">forced_pendulum_equations</span><span class="p">,</span> <span class="p">[</span><span class="n">theta_init</span><span class="p">,</span> <span class="n">theta_dot_init</span><span class="p">],</span>
<div class="newline"></div>                            <span class="n">t_range</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="n">omega</span><span class="p">))</span>
<div class="newline"></div>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">t_range</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<p>On peut à présent intégrer une trajectoire:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">omega</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">/</span><span class="mi">3</span>
<div class="newline"></div><span class="n">dt</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">omega</span> <span class="o">/</span> <span class="mi">25</span>
<div class="newline"></div><span class="n">tf</span> <span class="o">=</span> <span class="mi">1000</span>
<div class="newline"></div><span class="n">t</span><span class="p">,</span> <span class="n">theta_0</span><span class="p">,</span> <span class="n">theta_dot_0</span> <span class="o">=</span> <span class="n">forced_pendulum</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<div class="newline"></div>    <span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="n">omega</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Pour cette trajectoire, l&#8217;évolution de <img class="math" src="_images/math/52e8ed7a3ba22130ad3984eb2cd413406475a689.png" alt="\theta" style="vertical-align: 0px"/> reste périodique,
avec la même période que la période de forçage</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<div class="newline"></div><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">theta_0</span><span class="p">)</span> <span class="c"># courbe bleue</span>
<div class="newline"></div></pre></div>
</div>
<p>Quand on augmente l&#8217;amplitude du forçage, le mouvement reste périodique
après un régime transitoire assez long. On observe par contre un
doublement de période, l&#8217;amplitude de l&#8217;oscillation varie entre deux
périodes du forçage</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">t</span><span class="p">,</span> <span class="n">theta_1</span><span class="p">,</span> <span class="n">theta_dot_1</span> <span class="o">=</span> <span class="n">forced_pendulum</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<div class="newline"></div>    <span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="mf">1.08</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="n">omega</span><span class="p">)</span>
<div class="newline"></div><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">theta_1</span><span class="p">)</span> <span class="c"># courbe verte</span>
<div class="newline"></div></pre></div>
</div>
<p>Enfin, quand on augmente encore l&#8217;amplitude du forçage, le mouvement
n&#8217;est plus périodique et semble &#8220;chaotique&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">t</span><span class="p">,</span> <span class="n">theta_2</span><span class="p">,</span> <span class="n">theta_dot_2</span> <span class="o">=</span> <span class="n">forced_pendulum</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<div class="newline"></div>    <span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="mf">1.17</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="n">omega</span><span class="p">)</span>
<div class="newline"></div><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">theta_2</span><span class="p">)</span> <span class="c"># courbe rouge</span>
<div class="newline"></div></pre></div>
</div>
<div class="figure">
<a class="reference external image-reference" href="auto_examples/plot_spectra.html"><img alt="_images/plot_spectra_1.png" src="_images/plot_spectra_1.png" style="width: 480.0px; height: 320.0px;" /></a>
</div>
<p>On va confirmer l&#8217;observation du doublement de période grâce à la
transformée de Fourier discrète des signaux. Pour la transformée de
Fourier discrète, il existe également un sous-module de <tt class="docutils literal"><span class="pre">SciPy</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">fftpack</span>
<div class="newline"></div></pre></div>
</div>
<p>Il faut tout d&#8217;abord sélectionner la partie du signal qui semble
périodique, c&#8217;est-à-dire enlever le régime transitoire. On utilise pour
cela un masque de booléens</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">time_mask</span> <span class="o">=</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">400</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">theta_0</span> <span class="o">=</span> <span class="n">theta_0</span><span class="p">[</span><span class="n">time_mask</span><span class="p">]</span>
<div class="newline"></div></pre></div>
</div>
<p>Comme on n&#8217;est pas intéressé par la fréquence nulle, on soustrait la
moyenne du signal</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">theta_0</span> <span class="o">-=</span> <span class="n">theta_0</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div></pre></div>
</div>
<p>Notons qu&#8217;on peut soustraire un scalaire à un tableau <tt class="docutils literal"><span class="pre">ndarray</span></tt> : la
soustraction est alors faite élément par élément.</p>
<p>On calcule la transformée de Fourier discrète de <img class="math" src="_images/math/62df86ba6c84c9e8a5008f0ad6bbefa5d9cf301f.png" alt="\theta_0" style="vertical-align: -4px"/>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fft_theta_0</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">theta_0</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Pour représenter la TF, il nous faut également un tableau des fréquences
correspondant au tableau fft_theta_0. Il y a pour cela une fonction
dédiée dans le module <tt class="docutils literal"><span class="pre">fftpack</span></tt>, <tt class="docutils literal"><span class="pre">fftfreq</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">theta_0</span><span class="p">),</span> <span class="n">dt</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>On peut alors représenter le module de la transformée de Fourier en
fonction de la fréquence</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_theta_0</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>On observe que la fréquence fondamentale du signal correspond à la
fréquence de forçage <img class="math" src="_images/math/9c2982e5610fcbb77a9f8b954f7c6c3049e1fa2e.png" alt="f_D" style="vertical-align: -6px"/>. On observe aussi une harmonique triple
à <img class="math" src="_images/math/72ab7033206e368a7bfa98066755084569db4eee.png" alt="3 f_D" style="vertical-align: -6px"/>.</p>
<div class="figure">
<a class="reference external image-reference" href="auto_examples/plot_fft.html"><img alt="_images/plot_fft_1.png" src="_images/plot_fft_1.png" style="width: 640.0px; height: 480.0px;" /></a>
</div>
<p>Pour le forçage intermédiaire, on refait la même série d&#8217;opérations</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">theta_1</span> <span class="o">=</span> <span class="n">theta_1</span><span class="p">[</span><span class="n">time_mask</span><span class="p">]</span>
<div class="newline"></div><span class="n">theta_1</span> <span class="o">-=</span> <span class="n">theta_1</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="n">fft_theta_1</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">theta_1</span><span class="p">)</span>
<div class="newline"></div><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_theta_1</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>On observe alors un nouveau pic à la fréquence moitiés <img class="math" src="_images/math/4ae6350e3b16d67f90299b301e6abe43cf07cfb6.png" alt="f_D/2" style="vertical-align: -7px"/>,
correspondant à un doublement de période.</p>
<p>Pour aller plus loin, on peut visualiser l&#8217;évolution du spectre de
<img class="math" src="_images/math/52e8ed7a3ba22130ad3984eb2cd413406475a689.png" alt="\theta" style="vertical-align: 0px"/> pour un grand nombre de paramètres en codant par la couleur l&#8217;amplitude du module de la transformée de Fourier:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">omega</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">/</span><span class="mi">3</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">omega</span> <span class="o">/</span> <span class="mi">25</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">tf</span> <span class="o">=</span> <span class="mi">1000</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">acc_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">fft_sig</span> <span class="o">=</span> <span class="p">[]</span>
<div class="newline"></div><span class="go">&gt;&gt;&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">400</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">hann</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">hanning</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<div class="newline"></div><span class="go">&gt;&gt;&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">acc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">acc_factors</span><span class="p">):</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span>    <span class="k">print</span> <span class="n">i</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span>    <span class="n">t</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">theta_dot</span> <span class="o">=</span> <span class="n">forced_pendulum</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span>                        <span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="n">omega</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span>    <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span>    <span class="n">theta</span> <span class="o">-=</span> <span class="n">theta</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span>    <span class="n">theta</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">theta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span>    <span class="n">theta</span> <span class="o">*=</span> <span class="n">hann</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span>    <span class="n">fft_sig</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fftpack</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<div class="newline"></div><span class="go">&gt;&gt;&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">fft_sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fft_sig</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_sig</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">500</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">aspect</span><span class="o">=</span><span class="s">&#39;auto&#39;</span><span class="p">,</span>
<div class="newline"></div><span class="go">            interpolation=&#39;nearest&#39;)</span>
<div class="newline"></div></pre></div>
</div>
<p>On observe alors la cascade de transition vers le chaos, avec des fenêtre
chaotiques et d&#8217;autres périodiques.</p>
<div class="figure">
<a class="reference external image-reference" href="auto_examples/plot_cascade.html"><img alt="_images/plot_cascade_1.png" src="_images/plot_cascade_1.png" style="width: 640.0px; height: 480.0px;" /></a>
</div>
<div class="topic">
<p class="topic-title first">Exercice</p>
<p>Une propriété des systèmes dynamiques chaotiques est leur grande
sensibilité aux conditions initiales : deux trajectoires initialement
très proches vont d&#8217;éloigner exponentiellement vite au cours du temps.</p>
<p>Dans le régime chaotique, on va vérifier que deux trajectoires
initialement très proches s&#8217;éloignent très vite. Pour les paramètres</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">omega</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">/</span><span class="mi">3</span>
<div class="newline"></div><span class="n">acc</span> <span class="o">=</span> <span class="mf">1.17</span>
<div class="newline"></div><span class="n">q</span> <span class="o">=</span> <span class="mf">0.5</span>
<div class="newline"></div><span class="n">eps</span> <span class="o">=</span> <span class="mf">1.e-8</span>
<div class="newline"></div></pre></div>
</div>
<p>initialiser deux trajectoires séparées par une distance <tt class="docutils literal"><span class="pre">eps</span></tt>
(conditions initiales <img class="math" src="_images/math/4887dfc3898067620f740a9028623724147ebc5a.png" alt="(\theta, 0)" style="vertical-align: -7px"/> et
<img class="math" src="_images/math/385fc4ada746ee07b2cba34fbad5cba60cf359ca.png" alt="(\theta + \epsilon, 0)" style="vertical-align: -7px"/>,  par exemple), et représenter leur
distance dans l&#8217;espace des phases au cours du temps</p>
<div class="math">
<p><img src="_images/math/0dfe1a20f4bb8e54b06940a9fcb4316bc45b1b03.png" alt="d_{12}(t) = \sqrt{(\theta_2(t) - \theta_1(t))^2 +
                    (\dot{\theta}_2(t) - \dot{\theta}_1(t))^2}"/></p>
</div><p>Pour vérifier que la distance grandit de manière exponentielle au
cours du temps, faire une représentation graphique en coordonnées
semi-logarithmiques (<tt class="docutils literal"><span class="pre">plt.semilogy</span></tt>).</p>
<div class="figure">
<a class="reference external image-reference" href="auto_examples/plot_chaos.html"><img alt="_images/plot_chaos_1.png" src="_images/plot_chaos_1.png" style="width: 480.0px; height: 320.0px;" /></a>
</div>
<p>[<a class="reference internal" href="auto_examples/plot_chaos.html#example-plot-chaos-py"><em>Solution de l&#8217;exercice</em></a>]</p>
</div>
<div class="topic">
<p class="topic-title first">Pour aller plus loin</p>
<p>On peut représenter en 3-D le cycle limite décrivant la dynamique du
pendule.</p>
<div class="figure">
<a class="reference external image-reference" href="auto_examples/plot_dyna.html"><img alt="_images/plot_dyna_1.png" src="_images/plot_dyna_1.png" style="width: 640.0px; height: 480.0px;" /></a>
</div>
<p>[<a class="reference internal" href="auto_examples/plot_dyna.html#example-plot-dyna-py"><em>Python source code</em></a>]</p>
</div>
</div>
<div class="section" id="input-output-comment-sauver-des-tableaux-et-charger-des-fichiers">
<h2>5.3. Input/output : comment sauver des tableaux, et charger des fichiers<a class="headerlink" href="#input-output-comment-sauver-des-tableaux-et-charger-des-fichiers" title="Lien permanent vers ce titre">¶</a></h2>
<p>Pour le moment, nous n&#8217;avons pas encore sauvé aucun de nos résultats ! On
peut facilement sauver un tableau NumPy sous deux formats :</p>
<blockquote>
<div><ul class="simple">
<li>en texte ascii avec <tt class="docutils literal"><span class="pre">np.savetxt</span></tt> (si on a besoin de voir le
tableau dans un éditeur de texte) pour les tableaux de dimension
&lt;= 2.</li>
<li>en format binaire de NumPy avec <tt class="docutils literal"><span class="pre">np.save</span></tt> (pour des fichiers
moins gros en mémoire)</li>
</ul>
</div></blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[ 0,  1,  2,  3,  4],</span>
<div class="newline"></div><span class="go">    [ 5,  6,  7,  8,  9],</span>
<div class="newline"></div><span class="go">    [10, 11, 12, 13, 14],</span>
<div class="newline"></div><span class="go">    [15, 16, 17, 18, 19],</span>
<div class="newline"></div><span class="go">    [20, 21, 22, 23, 24]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s">&#39;tableau.txt&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;tableau.npy&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="s">&#39;tableau.txt&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">625</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="s">&#39;tableau.npy&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">280</span>
<div class="newline"></div></pre></div>
</div>
<p>Pour des tableaux de dimension trois ou plus, il faut utiliser
<tt class="docutils literal"><span class="pre">np.save</span></tt></p>
<div class="highlight-python"><pre>&gt;&gt;&gt; b = np.ones((2, 1, 3, 4))
&gt;&gt;&gt; b.shape
(2, 1, 3, 4)
&gt;&gt;&gt; np.savetxt('b.txt', b)
Traceback (most recent call last):
File "&lt;ipython-input-13-1d7a297e3d85&gt;", line 1, in &lt;module&gt;
    np.savetxt('b.txt', b)
File "/usr/lib/python2.7/dist-packages/numpy/lib/npyio.py", line 979,
in savetxt
    fh.write(asbytes(format % tuple(row) + newline))
TypeError: float argument required, not numpy.ndarray

&gt;&gt;&gt; np.save('b.npy', b)</pre>
</div>
<p>De la même manière, il existe deux fonctions pour charger un tableau
numpy à partir d&#8217;un fichier</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&#39;tableau.txt&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;tableau.npy&#39;</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Remarque</p>
<p>La librairie standard de Python permet de <a class="reference external" href="http://scipy-lectures.github.io/intro/language/io.html">sauver n&#8217;importe quelle
string dans un fichier</a> .</p>
<p class="last">Des modules spécialisés peuvent permettrent de sauver des tableaux
dans d&#8217;autres format : csv, hdf5, etc.</p>
</div>
</div>
<div class="section" id="ecriture-de-documentation">
<h2>5.4. Ecriture de documentation<a class="headerlink" href="#ecriture-de-documentation" title="Lien permanent vers ce titre">¶</a></h2>
<p>Dans l&#8217;exemple précédent du pendule forcé, la fonction
<tt class="docutils literal"><span class="pre">forced_pendulum</span></tt> est une fonction haut niveau, que l&#8217;utilisateur final
va souvent manipuler. Pour cela, il est recommandé d&#8217;écrire une bonne
documentation pour la fonction <tt class="docutils literal"><span class="pre">forced_pendulum</span></tt>. Il existe un standard
pour l&#8217;écriture de docstrings hérité de NumPy, et documenté sur
<a class="reference external" href="https://github.com/numpy/numpy/blob/master/doc/HOWTO_DOCUMENT.rst.txt">https://github.com/numpy/numpy/blob/master/doc/HOWTO_DOCUMENT.rst.txt</a>.
Les différentes sections sont toujours dans le même ordre, ce qui permet
une lecture rapide et efficace de la documentation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">forced_pendulum</span><span class="p">(</span><span class="n">t_end</span><span class="p">,</span> <span class="n">t_space</span><span class="p">,</span> <span class="n">theta_init</span><span class="p">,</span> <span class="n">theta_dot_init</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<div class="newline"></div>                            <span class="n">acc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<div class="newline"></div>    <span class="sd">&quot;&quot;&quot;</span>
<div class="newline"></div><span class="sd">    Integrate a trajectory for the forced pendulum.</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    Parameters</span>
<div class="newline"></div><span class="sd">    ----------</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    t_end : float</span>
<div class="newline"></div><span class="sd">        Final time of the trajectory (initial time is always 0).</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    t_space : float</span>
<div class="newline"></div><span class="sd">        Time_interval between two points of the trajectories</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    theta_init : float</span>
<div class="newline"></div><span class="sd">        Initial angular position</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    theta_dot_init : float, optional</span>
<div class="newline"></div><span class="sd">        Initial angular velocity (default 0)</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    q : float, optional</span>
<div class="newline"></div><span class="sd">        Damping (default 0.1)</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    acc : float, optional</span>
<div class="newline"></div><span class="sd">        Amplitude of the forcing (default 1)</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    omega : float, optional</span>
<div class="newline"></div><span class="sd">        Pulsation of forcing (default 1)</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    Returns</span>
<div class="newline"></div><span class="sd">    -------</span>
<div class="newline"></div><span class="sd">    t: ndarray of floats</span>
<div class="newline"></div><span class="sd">        array of times</span>
<div class="newline"></div><span class="sd">    theta: ndarray of floats</span>
<div class="newline"></div><span class="sd">        angular positions along the trajectory</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    theta_dot: ndarray of floats</span>
<div class="newline"></div><span class="sd">        angular velocities along the trajectory</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    Notes</span>
<div class="newline"></div><span class="sd">    -----</span>
<div class="newline"></div><span class="sd">    This function integrates the equation</span>
<div class="newline"></div><span class="sd">    .. math::</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">        \ddot{\\theta} + q \dot{\\theta} + \omega^2 \sin\\theta = A \sin</span>
<div class="newline"></div><span class="sd">            \omega_D t</span>
<div class="newline"></div>
<div class="newline"></div><span class="sd">    Examples</span>
<div class="newline"></div><span class="sd">    --------</span>
<div class="newline"></div><span class="sd">    &gt;&gt;&gt; t, theta, theta_dot =  forced_pendulum(100, 0.1, np.pi/3)</span>
<div class="newline"></div><span class="sd">    &gt;&gt;&gt; sol = forced_pendulum(100, 0.1, np.pi/3, theta_dot_init=1, acc=1.5)</span>
<div class="newline"></div><span class="sd">    &quot;&quot;&quot;</span>
<div class="newline"></div>    <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">t_space</span><span class="p">)</span>
<div class="newline"></div>    <span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">forced_pendulum_equations</span><span class="p">,</span> <span class="p">[</span><span class="n">theta_init</span><span class="p">,</span> <span class="n">theta_dot_init</span><span class="p">],</span>
<div class="newline"></div>                            <span class="n">t_range</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="n">omega</span><span class="p">))</span>
<div class="newline"></div>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">t_range</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<p><div style="clear: both"></div></p>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="aller_plus_loin.html" title="6. Et pour aller plus loin"
             >suivant</a></li>
        <li class="right" >
          <a href="edp_chaleur.html" title="4. Équations aux dérivées partielles : utilisation de NumPy"
             >précédent</a> |</li>
        <li><a href="index.html">Python scientifique - ENS Paris</a> &raquo;</li> 
      </ul>
    </div>
        <!-- your html code here -->
<a href="http://www.ens.fr"><img src="_static/ENS_Logo.png"
alt="ENS" height="100"></a>
<a href="http://www.inria.fr"><img src="_static/logo-inria.jpg"
alt="INRIA" height="60"></a>
<a href="http://www.saint-gobain-recherche.fr/fr/"><img
src="_static/logoSGR.png" alt="Saint-Gobain Recherche" height="60"></a>

<script language="JavaScript"
src="http://freehostedscripts.net/ocount.php?site=ID1953783&name=pages
 visitées"></script>

  </body>
</html>